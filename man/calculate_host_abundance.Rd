% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{calculate_host_abundance}
\alias{calculate_host_abundance}
\title{Calculate Host Relative Abundance}
\usage{
calculate_host_abundance(
  host_filtered,
  tpm_long,
  sample_total_tpm,
  sample_metadata,
  tax_level = "Phylum"
)
}
\arguments{
\item{host_filtered}{A data frame with columns `vOTU_id` and the specified
taxonomic level.}

\item{tpm_long}{A long-format data frame with columns `vOTU_id`, `sample_id`, `TPM`.}

\item{sample_total_tpm}{A data frame with columns `sample_id`, `total_TPM`.}

\item{sample_metadata}{A data frame with sample metadata including `sample_id`.}

\item{tax_level}{Character. Taxonomic level to summarize. Default: "Phylum".}
}
\value{
A data frame with relative abundance per sample and taxonomic group.
}
\description{
Calculates the relative abundance of predicted bacterial hosts at a
specified taxonomic level, relative to total viral TPM.
}
